<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Movie Ticket Booking</title>
    <link rel="stylesheet" href="../css/seat.css">
    <script src="../src/seats.js" defer></script>
</head>

<body>
    <div class="theme-toggle">
        <button id="theme-button">Toggle Theme</button>
    </div>
    <div class="main">
        <div class="movie-details">
            <img id="movie-poster" src="" alt="Movie Poster">
            <h2 id="movie-title"></h2>
            <p id="movie-runtime"></p>
            <p id="movie-genre"></p>
            <p id="movie-rating"></p>
            <p id="movie-language"></p>
        </div>
        <div class="tickets">
            <div class="ticket-selector">
                <div class="seats">
                    <div class="status">
                        <div class="item available">Available</div>
                        <div class="item booked">Booked</div>
                        <div class="item selected">Selected</div>
                    </div>
                    <div class="all-seats">
                        <!-- Seats will be dynamically added here -->
                    </div>
                </div>
                <div class="screentext">All Eyes Here Please</div>
            </div>
            <div class="price">
                <div class="total">
                    <span><span class="count">0</span> Tickets</span>
                    <div>â‚¹ <div class="amount">0</div>
                    </div>
                </div>
                <button type="button"
                    onclick="location.href='http://127.0.0.1:5500/Justice-Juggernauts_023/payment.html'">Book &
                    Pay</button>
            </div>
        </div>
    </div>
    <script>
        document.addEventListener('DOMContentLoaded', () => {
            const urlParams = new URLSearchParams(window.location.search);

            // Retrieve data from URL parameters
            const movieTitle = urlParams.get('title') || "Title Not Available";
            const moviePoster = urlParams.get('poster') || "https://via.placeholder.com/150";
            const movieRuntime = urlParams.get('runtime') || "Runtime Not Available";
            const movieGenre = urlParams.get('genre') || "Genre Not Available";
            const movieRating = urlParams.get('rating') || "Rating Not Available";
            const movieLanguage = urlParams.get('language') || "Language Not Available";

            // Update the HTML with movie details
            document.getElementById('movie-title').innerText = movieTitle;
            document.getElementById('movie-poster').src = moviePoster;
            document.getElementById('movie-runtime').innerText = `Runtime: ${movieRuntime}`;
            document.getElementById('movie-genre').innerText = `Genre: ${movieGenre}`;
            document.getElementById('movie-rating').innerText = `Rating: ${movieRating}`;
            document.getElementById('movie-language').innerText = `Language: ${movieLanguage}`;

            console.log('URL Parameters:', urlParams.toString());
            console.log('Rating:', movieRating);

        });

        // Generate seats dynamically
        const seatsContainer = document.querySelector('.all-seats');
        generateSeats(5, 10); // 5 rows, 10 columns

        // Handle seat selection and update count and amount
        const tickets = seatsContainer.querySelectorAll('input');
        tickets.forEach(ticket => {
            ticket.addEventListener('change', () => {
                let amount = parseInt(document.querySelector('.amount').textContent);
                let count = parseInt(document.querySelector('.count').textContent);

                if (ticket.checked) {
                    count += 1;
                    amount += 200;
                } else {
                    count -= 1;
                    amount -= 200;
                }
                document.querySelector('.amount').textContent = amount;
                document.querySelector('.count').textContent = count;
            });
        });

        // Toggle theme button
        document.getElementById('theme-button').addEventListener('click', () => {
            document.body.classList.toggle('dark-mode');
            document.body.classList.toggle('light-mode');
        });


        function generateSeats(rows, cols) {
            const container = document.querySelector('.all-seats');

            for (let row = 1; row <= rows; row++) {
                const rowDiv = document.createElement('div');
                rowDiv.classList.add('row');

                const rowLabel = document.createElement('div');
                rowLabel.classList.add('row-label');
                rowLabel.innerText = `Row ${row}`;
                rowDiv.appendChild(rowLabel);

                for (let col = 1; col <= cols; col++) {
                    const seatID = `s${(row - 1) * cols + col}`;
                    const isBooked = Math.random() < 0.5 ? 'booked' : '';

                    const seat = document.createElement('input');
                    seat.type = 'checkbox';
                    seat.name = 'tickets';
                    seat.id = seatID;
                    seat.classList.add('seat', isBooked);

                    const seatLabel = document.createElement('label');
                    seatLabel.htmlFor = seatID;
                    seatLabel.classList.add('seat-label');
                    seatLabel.innerText = col;

                    rowDiv.appendChild(seat);
                    rowDiv.appendChild(seatLabel);
                }
                container.appendChild(rowDiv);
            }
        }
    </script>
</body>

</html>